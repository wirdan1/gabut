<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Free Fire Diamond Top-Up</title>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            color: #333;
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background-color: #ff5722;
            color: white;
            padding: 20px 0;
            text-align: center;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .main-content {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        
        .order-form {
            flex: 1;
            min-width: 300px;
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .diamond-list {
            flex: 1;
            min-width: 300px;
            background: white;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        
        input, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }
        
        button {
            background-color: #ff5722;
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            width: 100%;
            transition: background-color 0.3s;
        }
        
        button:hover {
            background-color: #e64a19;
        }
        
        .diamond-item {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            border-bottom: 1px solid #eee;
        }
        
        .diamond-item:last-child {
            border-bottom: none;
        }
        
        .diamond-name {
            font-weight: 600;
        }
        
        .diamond-price {
            color: #ff5722;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 8px;
            max-width: 500px;
            width: 90%;
            text-align: center;
        }
        
        .qrcode-container {
            margin: 20px auto;
            width: 200px;
            height: 200px;
        }
        
        .order-info {
            margin-top: 20px;
            text-align: left;
        }
        
        .order-info p {
            margin-bottom: 8px;
        }
        
        .close-btn {
            background: #ff5722;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 20px;
        }
        
        .error {
            color: #f44336;
            margin-top: 10px;
            font-size: 14px;
        }
        
        .loading {
            display: none;
            text-align: center;
            margin: 20px 0;
        }
        
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-radius: 50%;
            border-top: 4px solid #ff5722;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Free Fire Diamond Top-Up</h1>
            <p>Top up diamonds quickly and securely</p>
        </header>
        
        <div class="main-content">
            <div class="order-form">
                <h2>Order Form</h2>
                <form id="topupForm">
                    <div class="form-group">
                        <label for="userID">Free Fire User ID</label>
                        <input type="text" id="userID" placeholder="Enter your Free Fire ID" required>
                    </div>
                    
                    <div class="form-group">
                        <label for="diamondAmount">Diamond Amount</label>
                        <select id="diamondAmount" required>
                            <option value="">Select diamond amount</option>
                            <option value="5">5 Diamonds (Rp 826)</option>
                            <option value="10">10 Diamonds (Rp 1,000)</option>
                            <option value="12">12 Diamonds (Rp 1,500)</option>
                            <option value="50">50 Diamonds (Rp 6,000)</option>
                            <option value="70">70 Diamonds (Rp 9,000)</option>
                            <option value="100">100 Diamonds (Rp 13,000)</option>
                            <option value="140">140 Diamonds (Rp 18,000)</option>
                            <option value="210">210 Diamonds (Rp 27,000)</option>
                            <option value="355">355 Diamonds (Rp 45,000)</option>
                            <option value="510">510 Diamonds (Rp 65,000)</option>
                            <option value="720">720 Diamonds (Rp 90,000)</option>
                            <option value="1450">1450 Diamonds (Rp 182,000)</option>
                            <option value="booyah pass">Booyah Pass (Rp 46,000)</option>
                        </select>
                    </div>
                    
                    <div class="loading" id="loading">
                        <div class="spinner"></div>
                        <p>Processing your order...</p>
                    </div>
                    
                    <div class="error" id="error"></div>
                    
                    <button type="submit">Proceed to Payment</button>
                </form>
            </div>
            
            <div class="diamond-list">
                <h2>Diamond Prices</h2>
                <div class="diamond-item">
                    <span class="diamond-name">5 Diamonds</span>
                    <span class="diamond-price">Rp 826</span>
                </div>
                <div class="diamond-item">
                    <span class="diamond-name">10 Diamonds</span>
                    <span class="diamond-price">Rp 1,000</span>
                </div>
                <div class="diamond-item">
                    <span class="diamond-name">12 Diamonds</span>
                    <span class="diamond-price">Rp 1,500</span>
                </div>
                <div class="diamond-item">
                    <span class="diamond-name">50 Diamonds</span>
                    <span class="diamond-price">Rp 6,000</span>
                </div>
                <div class="diamond-item">
                    <span class="diamond-name">70 Diamonds</span>
                    <span class="diamond-price">Rp 9,000</span>
                </div>
                <div class="diamond-item">
                    <span class="diamond-name">100 Diamonds</span>
                    <span class="diamond-price">Rp 13,000</span>
                </div>
                <div class="diamond-item">
                    <span class="diamond-name">140 Diamonds</span>
                    <span class="diamond-price">Rp 18,000</span>
                </div>
                <div class="diamond-item">
                    <span class="diamond-name">210 Diamonds</span>
                    <span class="diamond-price">Rp 27,000</span>
                </div>
                <div class="diamond-item">
                    <span class="diamond-name">355 Diamonds</span>
                    <span class="diamond-price">Rp 45,000</span>
                </div>
                <div class="diamond-item">
                    <span class="diamond-name">510 Diamonds</span>
                    <span class="diamond-price">Rp 65,000</span>
                </div>
                <div class="diamond-item">
                    <span class="diamond-name">720 Diamonds</span>
                    <span class="diamond-price">Rp 90,000</span>
                </div>
                <div class="diamond-item">
                    <span class="diamond-name">1450 Diamonds</span>
                    <span class="diamond-price">Rp 182,000</span>
                </div>
                <div class="diamond-item">
                    <span class="diamond-name">Booyah Pass</span>
                    <span class="diamond-price">Rp 46,000</span>
                </div>
                <p style="margin-top: 20px; font-size: 14px; color: #666;">* Additional admin fee of 0.3% applies</p>
            </div>
        </div>
        
        <div class="modal" id="paymentModal">
            <div class="modal-content">
                <h2>Payment QR Code</h2>
                <div class="qrcode-container" id="qrcode"></div>
                
                <div class="order-info" id="orderInfo">
                    <!-- Order information will be inserted here -->
                </div>
                
                <button class="close-btn" id="closeModal">Close</button>
            </div>
        </div>
        
        <footer>
            <p>&copy; 2023 Free Fire Top-Up Service. Not affiliated with Garena.</p>
        </footer>
    </div>
    
    <script>
        // Diamond mapping and prices
        const diamondMapping = {
            5: "FF5-S24",
            10: "FF_10--16",
            12: "FF12-S113",
            50: "FF_50--2",
            70: "FF_70--16",
            100: "FF_100--2",
            140: "FF_140--73",
            210: "FF_210--16",
            355: "FF_355--73",
            510: "FF_510--73",
            720: "FF_720--73",
            1450: "FF_1450--73",
            "booyah pass": "FF_BP--73",
            "bp": "FF_BP--73"
        };
        
        const diamondPrices = {
            5: 826,
            10: 1000,
            12: 1500,
            50: 6000,
            70: 9000,
            100: 13000,
            140: 18000,
            210: 27000,
            355: 45000,
            510: 65000,
            720: 90000,
            1450: 182000,
            "booyah pass": 46000,
            "bp": 46000
        };
        
        // Form submission
        document.getElementById('topupForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const userID = document.getElementById('userID').value.trim();
            const diamondAmount = document.getElementById('diamondAmount').value;
            const errorElement = document.getElementById('error');
            const loadingElement = document.getElementById('loading');
            
            // Validate inputs
            if (!userID) {
                errorElement.textContent = 'Please enter your Free Fire ID';
                return;
            }
            
            if (!diamondAmount) {
                errorElement.textContent = 'Please select diamond amount';
                return;
            }
            
            errorElement.textContent = '';
            loadingElement.style.display = 'block';
            
            try {
                // Prepare request headers and body
                const headers = {
                    "content-type": "application/json",
                    "x-app-instance-id": "c07e0b553bf54f39956591553c7d4c64",
                    "x-original-url": "https://www.tokogame.com/id-id/digital/free-fire-diamonds",
                    "x-request-id": "4b4ecec1-805e-4da6-9c11-6fefbfa1d3e1",
                    "x-secret-id": "d30b58ad135594f78526dc6b2a9a459f033dde902d78bc808b16c054d003985a",
                    "x-currency": "IDR",
                    "x-language": "ID",
                    "x-region": "ID",
                    "referer": "https://www.tokogame.com/",
                    "origin": "https://www.tokogame.com",
                    "user-agent": "Mozilla/5.0 (Linux; Android 10; K)"
                };
                
                const body = {
                    contact: {
                        emailAddress: "",
                        phoneNumber: "+6283849737975"
                    },
                    paymentMethod: "QRIS_ID_BNC",
                    productId: "644359b1f61740160ca158ca",
                    productPackageCode: diamondMapping[diamondAmount],
                    questionnaireAnswers: [
                        {
                            questionnaire: {
                                code: "userid",
                                inputType: "STRING",
                                translations: [
                                    {
                                        language: "ID",
                                        question: "Masukkan User ID",
                                        description: "User ID"
                                    }
                                ]
                            },
                            answer: userID
                        }
                    ]
                };
                
                // Make API request
                const response = await axios.post("https://api.tokogame.com/core/v1/orders/create-order", body, { headers });
                const result = response.data?.data;
                
                if (!result || !result.checkoutUrl?.qr) {
                    throw new Error("QR code not found in response");
                }
                
                // Calculate total price with admin fee
                const basePrice = result.totalPriceInCents ? parseInt(result.totalPriceInCents / 100) : diamondPrices[diamondAmount];
                const adminFee = Math.ceil(basePrice * 0.003);
                const totalPrice = basePrice + adminFee;
                
                // Display payment modal
                document.getElementById('qrcode').innerHTML = '';
                new QRCode(document.getElementById('qrcode'), {
                    text: result.checkoutUrl.qr,
                    width: 200,
                    height: 200
                });
                
                // Set order information
                document.getElementById('orderInfo').innerHTML = `
                    <p><strong>ID:</strong> ${userID}</p>
                    <p><strong>Amount:</strong> ${diamondAmount} Diamonds</p>
                    <p><strong>Order ID:</strong> ${result.id || "N/A"}</p>
                    <p><strong>Status:</strong> ${result.paymentStatus || "Pending"}</p>
                    <p><strong>Total:</strong> Rp ${totalPrice.toLocaleString("id-ID")} (includes admin fee)</p>
                    <p><strong>Expires:</strong> 2 hours</p>
                    <p><strong>Method:</strong> ${result.paymentMethodDisplayText || "QRIS"}</p>
                    <p><strong>Product:</strong> ${result.productPackage?.code || "-"}</p>
                `;
                
                // Show modal
                document.getElementById('paymentModal').style.display = 'flex';
                
            } catch (err) {
                errorElement.textContent = `Failed to create order: ${err.message}`;
                console.error(err);
            } finally {
                loadingElement.style.display = 'none';
            }
        });
        
        // Close modal
        document.getElementById('closeModal').addEventListener('click', function() {
            document.getElementById('paymentModal').style.display = 'none';
        });
    </script>
</body>
</html>
